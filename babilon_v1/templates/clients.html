{% extends 'base_orders.html' %}
{% load static %}
{% block content %}

<div class="row col-12 m-2" id="search_div">
    <h5 class="text-left col-12 m-2">Znajdź klienta</h5>
    <input name="search" id="search_client" class="text-left" maxlength="15"><br>
    <button id="add_new_client" class="col-2 text-center m-3 btn-success">Dodaj klienta</button>
</div>
<div class="container-fluid row mx-auto mt-3" id="new_client">
    <div class="row col-10  mx-auto">
        <form method="POST" enctype="multipart/form-data" class="col-12 text-left">
            {% csrf_token %}
            <input name="order" value="{{order.id}}" type="hidden">
            <label class="text-left mt-2">Numer telefonu</label><br>
            <input name="phone_number" id="phone_number" class="text-left" maxlength="15" value="" type="text"><span
                class="col-1"></span><span id="ok" class="text-danger"></span><br>
            <label class="text-left mt-2">Adres</label><br>
            <input name="address" id="address" class="text-left" value="" type="text" size="32" maxlength="128"><br>
            <label class="text-left mt-2">Imie, nazwisko</label><br>
            <input name="firstlastname" id="firstlastname" class="text-left" value="" type="text" size="32"
                maxlength="128"><br>
            <label class="text-left mt-2">Uwagi</label><br>
            <input name="info" id="info" class="text-left" value="" type="text" size="32" maxlength="128"><br>
            <button class=" text-right mt-2 btn btn-success"><input class="text-right btn btn-success" type="submit"
                    value="dodaj"></button>
        </form>
    </div>
    <a href="/clients/" class="col-2 mt-2 text-right"><button class="text-right btn btn-danger">Powrót</button></a>
</div>

<div id="client" class="col-12 row mx-auto bg-light p-1 border m-2">
    <table class="table mx-auto col-12 ">
        <thead>
            <tr>
                <th scope="col">ID</th>
                <th scope="col">Telefon</th>
                <th scope="col">dane</th>
                <th scope="col">Dodaj adres</th>
                <th scope="col">Adres</th>
                <th scope="col">Status</th>
                <th scope="col">Info</th>
            </tr>
        </thead>
        <tbody>
            {% for el in clients %}
            <tr class="lista">
                <th scope="row">{{el.id}}</th>
                <td>{{el.phone_number}}</td>
                {% if el.client_name.strip %}
                <td>{{el.client_name}}</td>
                {% else %}
                <td></td>
                {% endif %}
                <td><a class="col-1" href="/add_client_new_address/{{el.id}}"><button class="btn-success col-12">Dodaj
                            adres</button></a>
                </td>
                <td class="col-1">
                    <ul class="col-12 m-2 p-0">
                        {% for address in clients_addresses %}
                        {% if el.id == address.client_id.id %}
                        <li class="col-12 row m-2 p-0">
                            <a href="/add_client_to_order/{{address.id}}"
                                class="col-6 text-center m-2 p-0">{{address.street}} </a>
                            <span class="col-2 text-center m-2 p-0">Licznik:
                                {{address.choice_count}}</span>
                            <a class="col-1 m-2 p-0" href="/edit_address/{{address.id}}"><button
                                    class="btn-primary text-center">E</button></a>
                            <a class="col-1 m-2 p-0" href="/del_address/{{address.id}}"><button
                                    class="btn-danger text-center">X</button></a>
                        </li>
                        {% endif %}
                        {% endfor %}
                    </ul>
                </td>
                <td>{{el.get_status_display}}</td>
                {% if el.info.strip %}
                <td>{{el.info}}<br><a href="/edit_client/{{el.id}}"><i class="fas fa-address-card"></i></a></td>
                {% else %}
                <td><a href="/edit_client/{{el.id}}"><i class="fas fa-address-card"></i></a></td>
                {% endif %}
            </tr>
            {% endfor %}

        </tbody>
    </table>
</div>

{% endblock %}
{% block script %}
<script src="{% static "babilon/clients.js" %}" type="text/javascript"></script>
{% endblock %}